include _tpch_tables.slt.part

query
select
    ps_partkey,
    sum(ps_supplycost * ps_availqty) as value
from
    partsupp,
    supplier,
    nation
where
    ps_suppkey = s_suppkey
    and s_nationkey = n_nationkey
    and n_name = 'IRAN'
group by
    ps_partkey having
        sum(ps_supplycost * ps_availqty) > (
            select
                sum(ps_supplycost * ps_availqty) * 0.0001000000
            from
                partsupp,
                supplier,
                nation
            where
                ps_suppkey = s_suppkey
                and s_nationkey = n_nationkey
                and n_name = 'IRAN'
        )
order by
    value desc;
----
188 10119060.85
98 8615280.06
26 7973976.78
78 7237355.10
95 7185227.46
171 7097915.81
154 7023789.85
96 6712815.65
33 6062213.64
62 5659470.16
80 5092702.20
126 5072828.94
146 5059670.87
112 4417981.25
30 4412078.16
198 4040205.98
70 3650926.40
124 3606392.16
88 3117730.24
48 3087580.32
128 2969374.78
195 2781332.81
15 2617258.80
106 2451313.92
178 2363267.36
58 2348026.56
108 2318668.65
130 2147628.50
42 2075418.62
8 1705971.42
71 1704564.27
162 1655794.98
102 1603740.84
148 1420441.80
28 1360884.98
104 1340876.41
158 1162808.40
24 1138442.40
97 1095432.60
138 1024231.49
157 980594.00
133 973117.10
2 926829.75
38 881349.36
115 852703.35
18 747191.25
197 734180.55
179 728353.50
6 690254.75
57 630987.44
51 622249.54
170 559080.08
150 536837.60
118 516842.62
19 464872.80
119 456180.01
180 308539.84
12 277737.44
50 225485.68
151 212535.18
164 196486.92
196 179700.58
4 138390.78
168 137006.01
68 108038.28
46 106785.50
54 56739.08
64 53189.28
